!function r(a,o,s){function c(t,e){if(!o[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=o[t]={exports:{}},a[t][0].call(n.exports,function(e){return c(a[t][1][e]||e)},n,n.exports,r,a,o,s)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t,n){"use strict";function r(e){e.preventDefault();var a,o,t=document.getElementById("start").value,n=document.getElementById("end").value;t===l.start&&n===l.end||(function(e){var t,n=void 0===(n=e.type)?"info":n,r=e.msg,a=document.getElementsByClassName("alert");switch(n){case"info":t="alert-info";break;case"warning":t="alert-warning"}for(var o=0;o<a.length;o++)a[o].classList.add(t),a[o].innerText=r}({type:"info",msg:"running query.  please wait..."}),a=(e={start:t,end:n}).start,o=e.end,new Promise(function(t,n){var e="?start="+encodeURIComponent(a)+"&end="+encodeURIComponent(o),r=new XMLHttpRequest;r.open("GET","/handy/shopify_analytics"+e,!0),r.send(),r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE)try{var e=JSON.parse(r.responseText);return e.error?n(new Error(e.error)):(l.data=e.data,t())}catch(e){return n(new Error("error getting report from backend - "+e.message))}}}).then(function(){return new Promise(function(e,t){var i=["mrr","customer_adds","customer_losses"],d=l.data;return["customer_count","customer_adds","customer_losses","plan_changes"].forEach(function(u){("customer_count"===u?["mrr","customer_count"]:[u]).forEach(function(a){var t="",e=document.getElementById(a).getContext("2d"),n={title:{display:!1,text:a},scales:{yAxes:[{ticks:{stepSize:1,suggestedMin:0}}]}},o={labels:Object.keys(d[u]),datasets:[]},r=[];o.labels.forEach(function(e){var t;switch(a){case"customer_count":case"mrr":t=d[u][e][a];break;default:t=d[a][e]}Object.keys(t).forEach(function(e){r.includes(e)||r.push(e)})});var s=r.length,c={};i.includes(a)&&r.forEach(function(e){c[e]={sum:0,count:0,avg:null,max:0}}),r.forEach(function(n,e){var r={lineTension:0,label:n,borderColor:function(e,t){t<1&&(t=1);return"hsl("+e*(360/t)%360+",100%,50%)"}(e,s),backgroundColor:"hsl(0,0%,99%)",data:[]};o.labels.forEach(function(e){var t;switch(a){case"customer_count":case"mrr":t=d[u][e][a];break;default:t=d[u][e]}r.data.push(t[n]),c[n]&&(c[n].sum+=t[n]||0,c[n].count++,c[n].max=Math.max(c[n].max,t[n]||0))}),o.datasets.push(r)}),l.charts[a]&&l.charts[a].destroy(),l.charts[a]=new Chart(e,{type:"line",data:o,options:n}),i.includes(a)&&Object.keys(c).forEach(function(e){c[e].avg=Math.round(c[e].sum/c[e].count),t+='\n                <div class="d-inline-block pr-5 pl-3">\n                <p class="font-weight-bold" >'.concat(e,"</p>\n                <p>Average: ").concat(c[e].avg," </p>\n                <p>Maximum: ").concat(c[e].max," </p>\n                </div>\n              ")});n=document.getElementById(a+"_stats");n&&(n.innerHTML=t)})}),e()})}).then(function(){l.start=t,l.end=n}))}function a(){var e=document.getElementById("start").value;document.getElementById("end").min=e}function o(e){return(e=e.toString(10)).length<2&&(e="0"+e),e}var l;l={charts:{}},window.addEventListener("load",function(){(function(){var e=document.getElementById("submit");e&&e.addEventListener("click",r),document.getElementById("start").addEventListener("change",a)})(),function(){var e=document.getElementById("start"),t=document.getElementById("end"),n=(a=new Date).getFullYear(),r=o(a.getMonth()+1),a=o(a.getDate()),a=n+"-"+r+"-"+a;e.max=a,t.max=a}()})},{}]},{},[1]);